/*!************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2011 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/
s7sdk.pkg("s7sdk.set");s7sdk.Util.require("s7sdk.common.Geometry");s7sdk.Util.require("s7sdk.common.ItemDesc");s7sdk.Util.require("s7sdk.common.IS");s7sdk.Util.require("s7sdk.event.Event");if(!s7sdk.set.PageScrubberControl){s7sdk.set.PageScrubberControl=function(a){arguments.callee.superclass.apply(this,[a,s7sdk.set.PageScrubberControl.NS,a.constructor,s7sdk.set.PageScrubber.RESTRICTED_STYLES])};s7sdk.set.PageScrubberControl.NS="s7sdk.set.PageScrubberControl";s7sdk.set.PageScrubberControl.prototype.rebuild=function(d){var e,b;e=this.component.wid;b=this.component.hei;var c=new s7sdk.Point2D(this.component.currentMousePoint.x,this.component.currentMousePoint.y);var a=this.component.pageIndex;this.superproto.rebuild.apply(this,[d]);if(e&&b){this.component.resize(e,b)}this.component.setCurrentMousePoint(c);this.component.adjustTrackPos();this.component.pageIndex=a}}s7sdk.Class.inherits(s7sdk.set.PageScrubberControl.NS,"s7sdk.ControlComponent");if(!s7sdk.set.PageScrubber){s7sdk.set.PageScrubber=function PageScrubber(b,e,d){var f=!!arguments[3];s7sdk.Logger.log(s7sdk.Logger.CONFIG,"s7sdk.set.PageScrubber constructor - containerId: %0, settings: %1 , compId: %2",b,e,d);this.splitFrames={orientation:false};d=(typeof d=="string"&&d.length)?d:"PageScrubber_"+s7sdk.Util.createUniqueId();this.id=(s7sdk.Util.isNull(d)?"":d);arguments.callee.superclass.apply(this,[d,b,"div","s7pagescrubber",e,!f]);this.createElement();this.uiContainer=s7sdk.Util.byId(b);var c=this.getParent();if(this.obj.parentNode!=c){c.appendChild(this.obj)}this.wid=undefined;this.hei=undefined;this.scrubberOffset=0;this.track=null;this.dragButton=null;this.mediaSet=null;this.logicalPage=0;this.prevPage=-1;this.pageCount=0;this.calculatedStyles={};this.pageIndex=1;this.pageData=[];this.pageTicks=[];this.locale=this.getParam("locale","");this.okToShowImage=false;var a=this;this.__mouseDown=function(g){a.mouseDown(g)};this.__mouseMove=function(g){a.mouseMove(g)};this.__mouseUp=function(g){a.mouseUp(g)};this.__trackClick=function(g){a.trackClick(g)};this.mouseIsDown=false;this.maxldradius=parseInt(this.maxloadradius);this.preloadImg=(this.pagethumb=="image")&&this.maxldradius>=0;if(this.preloadImg){this.delay=50;this.queue=new Array();this.timer=setInterval(s7sdk.Util.wrapContext(this.onProcess,this),this.delay)}this.parseSettings();if(!f){return new s7sdk.set.PageScrubberControl(this)}else{return this}};s7sdk.Class.inherits("s7sdk.set.PageScrubber","s7sdk.UIComponent");s7sdk.set.PageScrubber.prototype.getComponent=function(){return this};s7sdk.set.PageScrubber.prototype.modifiers={serverUrl:{params:["serverUrl"],defaults:["/is/image/"]},asset:{params:["imageSet"],defaults:[""]},maxloadradius:{params:["value"],defaults:[1],ranges:["-1:"]},iscommand:{params:["value"],defaults:[""],parseParams:false},pagethumb:{params:["pagethumb"],defaults:["label"],ranges:[["none","label","image","singlepage","doublepage"]]},direction:{params:["direction"],defaults:["auto"],ranges:[["auto","left","right"]]},aligntotick:{params:["aligntotick"],defaults:[false]}};s7sdk.set.PageScrubber.prototype.symbols={PAGE_THUMB_TEXT:"Page"};s7sdk.set.PageScrubber.RESTRICTED_STYLES={"font-family":"font-family","font-size":"font-size","font-style":"font-style"};s7sdk.set.PageScrubber.prototype.getMediaSet=function(){return this.mediaSet};s7sdk.set.PageScrubber.prototype.setCSS=function(c,b,a){if(s7sdk.set.PageScrubber.RESTRICTED_STYLES[b]){throw new Error("You cannot set "+c+" : "+b+" CSS property for this component ")}else{this.superproto.setCSS.apply(this,[c,b,a])}};s7sdk.set.PageScrubber.prototype.setModifier=function(a){throw new Error("Trying to use setModifier on the Core class (PageScrubber) is unsupported! Please refer to SDK documentation on using setModifier.")};s7sdk.set.PageScrubber.prototype.parseSettings=function(){if(this.serverUrl.lastIndexOf("/")!=(this.serverUrl.length-1)){this.serverUrl+="/"}this.bubbleDiv=null;this.bubbleText=null;this.bubbleImage=null;this.currentMousePoint=new s7sdk.Point2D(0,0);this.showtmb=(this.pagethumb=="none")?false:true;this.alignLeft=(this.direction=="auto"?(this.settings.locale!="ja"?true:false):(this.direction=="left"?true:false));this.build();if(this.asset!=""){this.setAsset(this.asset)}};s7sdk.set.PageScrubber.prototype.calculateStyle=function(b,a,c){if(this.calculatedStyles[c]==null){this.calculatedStyles[c]={}}this.calculatedStyles[c][b]=a;s7sdk.Logger.log(s7sdk.Logger.INFO,"s7sdk.set.PageScrubber.calculateStyle - property: %0 value %1",b,a)};s7sdk.set.PageScrubber.prototype.cleanUp=function(a){if(this.obj){s7sdk.Util.removeTags(this.obj);this.track=null;this.bubbleDiv=null;this.dragButton=null}};s7sdk.set.PageScrubber.prototype.dispose=function(){this.cleanUp();if(this.obj){if(this.obj.parentElement){this.obj.parentElement.removeChild(this.obj)}}};s7sdk.set.PageScrubber.prototype.loadAsset=function(){s7sdk.Logger.log(s7sdk.Logger.INFO,"s7sdk.set.PageScrubber.loadAsset");this.okToShowImage=false;var a=this.serverUrl+s7sdk.MediaSetParser.parseAssetForSetReq(this.asset).req;if(s7sdk.Util.isNonEmptyString(this.labelKey)){a+="&labelkey="+this.labelKey}if(s7sdk.Util.isNonEmptyString(this.locale)){a+="&locale="+this.locale}if(this.isReq){this.isReq.cancelHttpReq()}this.isReq_=new s7sdk.IS(this.serverUrl,this.asset);this.isReq_.getHttpReq(a,function(c,b){s7sdk.set.PageScrubber.prototype.setRequestComplete.apply(b,[c])},function(c,b){s7sdk.set.PageScrubber.prototype.setRequestError.apply(b,[c])},this)};s7sdk.set.PageScrubber.prototype.setRequestComplete=function(b){var a=b.set;if(a==null){return}var c=s7sdk.MediaSetParser.parse(a,"");this.updateLandscapeLabels(c," - ");this.cleanUp(true);this.setMediaSet(c);this.build()};s7sdk.set.PageScrubber.prototype.updateLandscapeLabels=function(b,e){var d=b.items;var c=b.type!==s7sdk.ItemDescType.ECAT_SET;e=e?e:" : ";for(var f=0;f<d.length;f++){var g=d[f];var a=g.label;var h=undefined;if(g.images){if(g.images[0].label){a=g.images[0].label}if(g.images[1]&&g.images[1].label){h=g.images[1].label}}g.label=a;if(g.np||c){if(!g.label){g.label=h?h:""}}else{if(g.label){g.label+=h?e+h:""}else{g.label=h?h:""}}if(!g.label){g.label=""}}};s7sdk.set.PageScrubber.prototype.getNextToLoad=function(){if(this.pageData.length==0){return}var b=this.pageIndex-1-this.maxldradius;var c=this.pageIndex+this.maxldradius;if(b<0){b=0}if(c>this.pageData.length-1){c=this.pageData.length}if(b==c){return this.pageData[b]}else{for(var a=b;a<c;a++){if(!this.pageData[a].isComplete){return this.pageData[a]}}}};s7sdk.set.PageScrubber.prototype.onProcess=function(){var b=new Array();for(var a=0;a<3;a++){var c=this.queue[a];if(c!=null&&!c.isComplete){b.push(c)}else{var c=this.getNextToLoad();if(c){c.loadImage();b.push(c)}}}this.queue=b};s7sdk.set.PageScrubber.prototype.setRequestError=function(a){s7sdk.Logger.log(s7sdk.Logger.WARNING,"s7sdk.set.PageScrubber.setRequestError - response: %0",a)};s7sdk.set.PageScrubber.prototype.build=function(){var d,b;if(!this.wid){d=parseInt(s7sdk.Util.css.getCss("s7track","width",this.id,"s7pagescrubber",this.uiContainer));this.wid=d}else{d=this.wid}if(!this.hei){b=parseInt(s7sdk.Util.css.getCss("s7track","height",this.id,"s7pagescrubber",this.uiContainer));this.hei=b}else{b=this.hei}this.scrubberOffset=parseInt(s7sdk.Util.css.getCss("s7dragbutton","width",this.id,"s7pagescrubber",this.uiContainer))*0.5;this.imageWidth=s7sdk.Util.css.getCss("s7imgbubble","width",this.id,"s7pagescrubber",this.uiContainer);this.imageHeight=s7sdk.Util.css.getCss("s7imgbubble","height",this.id,"s7pagescrubber",this.uiContainer);var a=s7sdk.Util.createElement("div",{});a.className="s7track";this.track=a;if(this.wid>=0){d=this.wid;this.obj.style.width=this.formatValueForStyle(d);this.track.style.width=this.formatValueForStyle(d)}this.dragBounds=new s7sdk.Point2D(d,b);var c=s7sdk.Util.createElement("div",{});this.dragButton=c;c.className="s7dragbutton";this.obj.appendChild(a);a.appendChild(c);this.addInteraction(c);s7sdk.Event.addDOMListener(a,"click",this.__trackClick,false);if(!this.alignLeft){this.currentMousePoint=new s7sdk.Point2D(this.dragBounds.x,this.dragBounds.y)}this.adjustTrackPos();if(this.showtmb){this.buildBubble()}};s7sdk.set.PageScrubber.prototype.addInteraction=function(a){s7sdk.Event.addDOMListener(a,"mousedown",this.__mouseDown,false);s7sdk.Event.addDOMListener(a,"touchstart",this.__mouseDown,false)};s7sdk.set.PageScrubber.prototype.setMediaSet=function(b){s7sdk.Logger.log(s7sdk.Logger.FINE,"s7sdk.set.PageScrubber.setMediaSet - mediaSet: %0",b);if(b!=null){var a=b;if(!(b instanceof s7sdk.OrientationSetDesc)){a=new s7sdk.OrientationSetDesc(a,null)}if(a.landscape==null||typeof(a.landscape.items[0])=="undefined"){return}this.mediaSet=a;this.currentAsset=a;this.createIndexTexts(" - ");this.setPages();if(this.showtmb){this.buildBubble()}}};s7sdk.set.PageScrubber.prototype.createIndexTexts=function(c){var b=this.mediaSet.landscape.items;var a=this.mediaSet.landscape.type!==s7sdk.ItemDescType.ECAT_SET;this.indexTextLandscape=[];var e=1;c=c?c:" - ";for(var d=0;d<b.length;d++){var f=b[d];this.indexTextLandscape[d]=e.toString();if(!(f.np||a)){e++;this.indexTextLandscape[d]+=c+e}e++}this.indexTextPortrait=[];if(this.mediaSet.portrait){b=this.mediaSet.portrait.items;for(var d=0;d<b.length;d++){this.indexTextPortrait[d]=(d+1).toString()}}};s7sdk.set.PageScrubber.prototype.setPages=function(){this.items=this.splitFrames.orientation?this.mediaSet.portrait.items:this.mediaSet.landscape.items;this.pageCount=this.items.length;this.buildPageData();this.buildTicks()};s7sdk.set.PageScrubber.prototype.setCurrentMousePoint=function(a){if(a){this.currentMousePoint=a}};s7sdk.set.PageScrubber.prototype.buildTicks=function(){var b=Math.ceil(this.dragBounds.x/this.pageCount);var c=[];for(var a=0;a<this.pageCount-1;a++){c.push(a*b+(a!=0?b/2:0))}c.push(this.dragBounds.x);this.pageTicks=c};s7sdk.set.PageScrubber.prototype.buildPageData=function(){var d=1;var g=this.getLocalizedText("PAGE_THUMB_TEXT");this.pageData=[];for(var c=0;c<this.pageCount;c++){var f={};var e="";var h=this.items[c];if(typeof(h.label)!="undefined"&&h.label!=""){e=h.label}else{e=g+" "+(this.splitFrames.orientation?this.indexTextPortrait[c]:this.indexTextLandscape[c])}var b=h.name;var a=this.generateImageUrl(b);f.text=e;f.image=a;f.isLoading=false;f.isComplete=false;f.loadImage=this.loadImage;f.owner=this;f.page=c;this.pageData.push(f);if(this.pagethumb=="image"&&!this.preloadImg){f.loadImage()}}if(!this.alignLeft){this.pageData.reverse();this.pageIndex=this.pageCount}};s7sdk.set.PageScrubber.prototype.generateImageUrl=function(a){var b=this.serverUrl;b+=a;if(b.indexOf("?")>-1){b+="&layer=comp&"}else{b+="?"}b+="hei="+parseInt(this.imageHeight);if(this.iscommand&&this.iscommand.length>0){b+="&"+unescape(this.iscommand)}if(s7sdk.Util.isNonEmptyString(this.locale)){b+="&locale="+this.locale}return b};s7sdk.set.PageScrubber.prototype.loadImage=function(){if(this.isLoading){return}var a=document.createElement("img");a.src=this.image;this.img_=a;var b=this;b.isLoading=true;if(b.img_.complete){b.isComplete=true;b.img_=null;b.owner.updateBubble(b)}else{a.onabort=a.onerror=a.onload=function(c){b.img_=null;b.isComplete=true;b.owner.updateBubble(b)}}};s7sdk.set.PageScrubber.prototype.trackClick=function(a){if(this.pageCount<=0){return}s7sdk.Event.preventDefault(a);s7sdk.Event.stopPropagation(a);var b=typeof(a.target)!="undefined"?a.target:a.srcElement;if(b==this.track){if(!this.okToShowImage){this.okToShowImage=true}this.proceedPositioning(a)}};s7sdk.set.PageScrubber.prototype.proceedPositioning=function(e){var a=s7sdk.Util.getObjPos(this.obj).x;var d=s7sdk.Util.getEventPos(e).x-(a);var c=s7sdk.Util.getEventPos(e).y;this.currentMousePoint=new s7sdk.Point2D(d,c);if(this.aligntotick){if((this.currentMousePoint.x-this.scrubberOffset)<=0){this.currentMousePoint.x=0}else{if(this.currentMousePoint.x>this.dragBounds.x){this.currentMousePoint.x=this.dragBounds.x-this.scrubberOffset}}}else{this.adjustTrackPos()}var b=Math.ceil(this.pageCount-((this.dragBounds.x-this.currentMousePoint.x)/this.dragBounds.x)*this.pageCount);b=(b>this.pageCount)?this.pageCount:(b<=0)?1:b;this.proceedPageset(b,false)};s7sdk.set.PageScrubber.prototype.proceedPageset=function(b,c){if(this.aligntotick||c){this.currentMousePoint.x=this.pageTicks[b-1];this.adjustTrackPos()}var a=b!=this.pageIndex;this.pageIndex=b;this.showBubble();var d=this;setTimeout(function(){if(d.showtmb){d.removeBubble()}},2000);(this.pagethumb=="image")?this.setImage():this.setText();this.logicalPage=this.pageData[this.pageIndex-1].page;if(a){this.dispatchEvent(new s7sdk.event.SliderEvent(s7sdk.event.SliderEvent.NOTF_SLIDER_MOVE,[this.logicalPage],false));this.dispatchEvent(new s7sdk.event.AssetEvent(s7sdk.event.AssetEvent.ITEM_SELECTED_EVENT,this.getLogicalCurrentAsset(),this.logicalPage,false))}};s7sdk.set.PageScrubber.prototype.mouseDown=function(d){if(this.pageCount<=0){return}d=d||window.event;s7sdk.Event.preventDefault(d);this.mouseIsDown=true;this.prevPage=this.logicalPage;if(!this.okToShowImage){this.okToShowImage=true}this.showBubble();var a=s7sdk.Util.getObjPos(this.obj).x;var c=s7sdk.Util.getEventPos(d).x-(a);var b=s7sdk.Util.getEventPos(d).y;this.currentMousePoint=new s7sdk.Point2D(c,b);s7sdk.Event.addDOMListener(document,"mousemove",this.__mouseMove,false);s7sdk.Event.addDOMListener(document,"mouseup",this.__mouseUp,false);s7sdk.Event.addDOMListener(document,"touchmove",this.__mouseMove,false);s7sdk.Event.addDOMListener(document,"touchend",this.__mouseUp,false);this.dispatchEvent(new s7sdk.event.SliderEvent(s7sdk.event.SliderEvent.NOTF_SLIDER_DOWN,[this.logicalPage],false))};s7sdk.set.PageScrubber.prototype.mouseMove=function(e){if(this.pageCount<=0){return}e=e||window.event;s7sdk.Event.preventDefault(e);var a=s7sdk.Util.getObjPos(this.obj).x;var d=s7sdk.Util.getEventPos(e).x-(a);var c=s7sdk.Util.getEventPos(e).y;this.adjustTrackPos();this.currentMousePoint=new s7sdk.Point2D(d,c);var b=Math.ceil(this.pageCount-((this.dragBounds.x-this.currentMousePoint.x)/this.dragBounds.x)*this.pageCount);b=(b>this.pageCount)?this.pageCount:(b<=0)?1:b;if(b!=this.pageIndex){this.pageIndex=b;(this.pagethumb=="image")?this.setImage():this.setText();this.logicalPage=this.pageData[this.pageIndex-1].page;this.dispatchEvent(new s7sdk.event.SliderEvent(s7sdk.event.SliderEvent.NOTF_SLIDER_MOVE,[this.logicalPage],false))}};s7sdk.set.PageScrubber.prototype.adjustTrackPos=function(){if((this.currentMousePoint.x-this.scrubberOffset)<=0){this.positionAt(0)}else{if(this.currentMousePoint.x>(this.dragBounds.x-this.scrubberOffset)){this.positionAt((this.dragBounds.x-(this.scrubberOffset*2)))}else{this.positionAt((this.currentMousePoint.x-this.scrubberOffset))}}};s7sdk.set.PageScrubber.prototype.setText=function(){if(typeof(this.bubbleText)=="undefined"||this.bubbleText==null){return}if(this.pageData[this.pageIndex-1]){var a=this.pageData[this.pageIndex-1].text;if(typeof(this.bubbleText.textContent)!="undefined"){this.bubbleText.textContent=a}else{this.bubbleText.nodeValue=a}}};s7sdk.set.PageScrubber.prototype.setImage=function(){if(typeof(this.bubbleImage)=="undefined"||this.bubbleImage==null){return}var a=this.pageData[this.pageIndex-1];if(a&&a.isComplete){this.bubbleImage.src=a.image;this.bubbleDiv.style.visibility="visible"}else{this.bubbleDiv.style.visibility="hidden"}s7sdk.Logger.log(s7sdk.Logger.INFO,"s7sdk.set.PageScrubber.setImage - img: %0",a)};s7sdk.set.PageScrubber.prototype.updateBubble=function(a){if(this.bubbleImage&&((this.pageIndex-1)==a.page)){this.bubbleImage.src=a.image;if((this.bubbleDiv)&&(this.okToShowImage)){this.bubbleDiv.style.visibility="inherit"}else{if(this.bubbleDiv){this.bubbleDiv.style.visibility="hidden"}}}};s7sdk.set.PageScrubber.prototype.positionAt=function(a){s7sdk.Logger.log(s7sdk.Logger.FINE,"s7sdk.set.PageScrubber.positionAt - val: %0",a);this.dragButton.style.left=this.formatValueForStyle(a)};s7sdk.set.PageScrubber.prototype.buildBubble=function(){if((this.bubbleDiv)||!(this.dragButton)){return}this.bubbleDiv=s7sdk.Util.createElement("div",{});var c=(this.pagethumb=="image")?this.buildImageBubble():this.buildTextBubble();this.bubbleDiv.appendChild(c);this.bubbleDiv.className=(this.pagethumb=="image")?"s7imgbubble":"s7bubble";var b=".s7bubble";if(this.bubbleDiv.className=="s7imgbubble"){b=".s7imgbubble"}for(var a in this.calculatedStyles[".s7pagescrubber "+b]){this.bubbleDiv.style[a]=this.calculatedStyles[".s7pagescrubber "+b][a]}this.dragButton.appendChild(this.bubbleDiv);if(this.pagethumb=="image"){this.setImage()}else{this.setText()}this.bubbleDiv.style.visibility="hidden"};s7sdk.set.PageScrubber.prototype.showBubble=function(){if(this.bubbleDiv){this.bubbleDiv.style.visibility="visible";this.setText()}};s7sdk.set.PageScrubber.prototype.hideBubble=function(){if(this.bubbleDiv){this.bubbleDiv.style.visibility="hidden"}};s7sdk.set.PageScrubber.prototype.buildTextBubble=function(){var a=document.createTextNode("");this.bubbleText=a;return a};s7sdk.set.PageScrubber.prototype.buildImageBubble=function(){var a=document.createElement("img");this.bubbleImage=a;return a};s7sdk.set.PageScrubber.prototype.formatValueForStyle=function(b){var a=b.toString();if((a.lastIndexOf("px")!=-1)&&(a.lastIndexOf("px")==(a.length-2))){return a}else{return a+"px"}};s7sdk.set.PageScrubber.prototype.removeBubble=function(){this.hideBubble()};s7sdk.set.PageScrubber.prototype.mouseUp=function(c){c=c||window.event;s7sdk.Event.preventDefault(c);this.mouseIsDown=false;if(this.showtmb){this.removeBubble()}s7sdk.Event.removeDOMListener(document,"mousemove",this.__mouseMove,false);s7sdk.Event.removeDOMListener(document,"mouseup",this.__mouseUp,false);s7sdk.Event.removeDOMListener(document,"touchmove",this.__mouseMove,false);s7sdk.Event.removeDOMListener(document,"touchend",this.__mouseUp,false);if(this.prevPage!=this.logicalPage){this.dispatchEvent(new s7sdk.event.SliderEvent(s7sdk.event.SliderEvent.NOTF_SLIDER_UP,this.logicalPage,false));this.dispatchEvent(new s7sdk.event.AssetEvent(s7sdk.event.AssetEvent.ITEM_SELECTED_EVENT,this.getLogicalCurrentAsset(),this.logicalPage,false));this.prevPage=this.logicalPage}if(this.aligntotick){this.proceedPositioning(c)}else{var e=/.*[^px]/;var b=this.dragButton.style.left;var a=e.exec(b);var d=this.dragButton.offsetWidth*0.5;if(a.length>0){this.currentMousePoint.x=(parseInt(a[0])+d)}}};s7sdk.set.PageScrubber.prototype.setPortrait=function(){this.setSplitFrames(true)};s7sdk.set.PageScrubber.prototype.setLandscape=function(){this.setSplitFrames(false)};s7sdk.set.PageScrubber.prototype.setSplitFrames=function(c){if(this.splitFrames.orientation==c){return c}if(this.mediaSet.portrait==null){this.splitFrames.orientation=false;return false}this.splitFrames.orientation=c;if(this.mediaSet){this.orientationChanged=true;this.items=c?this.mediaSet.portrait.items:this.mediaSet.landscape.items;var a=this.getCurrentFrameIndex();var b=c?this.mediaSet.getPortraitIndex(a):this.mediaSet.getLandscapeIndex(a);this.setPages();this.setCurrentFrameIndex(b)}return c};s7sdk.set.PageScrubber.prototype.getLogicalCurrentAsset=function(){var b=this.items;var a=b[this.logicalPage];return a};s7sdk.set.PageScrubber.prototype.setAsset=function(c){if(typeof c!="string"){throw new Error("Asset name must be represented by a string!")}s7sdk.Logger.log(s7sdk.Logger.FINE,"s7sdk.set.PageScrubber.setAsset - asset: %0",c);var a=unescape(c);this.currentAsset=c;if(this.asset!=null&&a!=this.asset){var b=new s7sdk.UserEvent(s7sdk.UserEvent.SWAP,[0,c],true);s7sdk.Event.dispatch(this.obj,b,false)}this.asset=a;this.loadAsset()};s7sdk.set.PageScrubber.prototype.addEventListener=function(c,b,a){s7sdk.Logger.log(s7sdk.Logger.FINE,"s7sdk.set.PageScrubber.addEventListener - type: %0, handler: %1, useCapture: %2",c,b.toString().substring(0,b.toString().indexOf("(")),a);this.superproto.addEventListener.apply(this,[c,b,a])};s7sdk.set.PageScrubber.prototype.getWidth=function(){return this.wid};s7sdk.set.PageScrubber.prototype.getHeight=function(){return parseInt(s7sdk.Util.css.getCss("s7pagescrubber","height",this.id,null,null))};s7sdk.set.PageScrubber.prototype.resize=function(c,g){s7sdk.Logger.log(s7sdk.Logger.FINE,"s7sdk.set.PageScrubber.resize - w: %0, h: %1",c,g);var b=(this.wid==0)?this.dragBounds.x:this.wid;var d=(c<this.wid);var e=Math.abs((b-c)/b);var f=(this.currentMousePoint.x<0)?0:this.currentMousePoint.x;var a=Math.round((f*e));if(!d){a=f+a}else{a=Math.abs(f-a)}this.wid=(c);this.hei=g;this.cleanUp(true);this.build();if(this.aligntotick){this.buildTicks()}this.logicalPage=0;this.currentMousePoint.x=a;this.adjustTrackPos()};s7sdk.set.PageScrubber.prototype.getCurrentFrameIndex=function(){return this.logicalPage};s7sdk.set.PageScrubber.prototype.setCurrentFrameIndex=function(b){var a=parseInt(b);if(this.logicalPage==a){return}if(a<0||a>(this.pageCount-1)){return}if(!this.alignLeft){a=this.pageCount-a-1}this.proceedPageset(a+1,true)};s7sdk.set.PageScrubber.prototype.getCurrentAsset=function(){return typeof this.currentAsset=="undefined"?null:this.currentAsset};s7sdk.set.PageScrubber.prototype.setCurrentAsset=function(a){if(typeof(a)=="string"){this.setAsset(a)}else{this.setMediaSet(a)}};(function addDefaultCSS(){var e=s7sdk.Util.css.createCssRuleText;var f=s7sdk.Util.css.createCssImgUrlText;var h=s7sdk.Util.css.createCssAnimationText;var j={background:"#49494A",position:"absolute",left:"-38px",top:"-30px",width:"100px",height:"26px","border-radius":"6px","text-align":"center","font-family":"Arial","font-size":"14px","line-height":"25px","word-wrap":"normal","white-space":"nowrap","overflow-wrap":"none","text-wrap":"none"};var g={background:"#49494A",position:"absolute","border-radius":"5px","text-align":"center","font-family":"Arial","font-size":"14px","line-height":"25px","word-wrap":"normal","white-space":"nowrap","overflow-wrap":"none","text-wrap":"none",width:"160px",height:"100px",top:"-115px",left:"-73px",padding:"5px"};var k={background:"#49494A",height:"24px",width:"24px","-moz-border-radius":"12px","-webkit-border-radius":"12px","border-radius":"12px",position:"absolute",top:"-4px",left:"0px",color:"white"};var b={width:"700px",height:"16px","text-align":"center","background-color":"#E5E5E8",position:"absolute",bottom:"0px","-moz-border-radius":"8px","-webkit-border-radius":"8px","border-radius":"8px"};var m={width:"700px",height:"100px",position:"absolute","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)"};var i=e(".s7pagescrubber",m);var d=e(".s7pagescrubber .s7track",b);var l=e(".s7pagescrubber .s7dragbutton",k);var a=e(".s7pagescrubber .s7bubble",j);var c=e(".s7pagescrubber .s7imgbubble",g);s7sdk.Util.css.addDefaultCSS(i+d+l+a+c,"PageScrubber")})()};